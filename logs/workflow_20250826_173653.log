2025-08-26 17:36:53,827 - __main__ - INFO - 日志文件: logs/workflow_20250826_173653.log
2025-08-26 17:36:53,827 - __main__ - INFO - === 开始执行飞书表格数据处理工作流 ===
2025-08-26 17:36:53,827 - __main__ - INFO - 🔧 步骤2: 初始化客户端连接
2025-08-26 17:36:53,827 - __main__ - INFO -    - 正在初始化飞书客户端...
2025-08-26 17:36:53,827 - __main__ - INFO -    ✅ 飞书客户端初始化完成
2025-08-26 17:36:53,827 - __main__ - INFO -    - 正在初始化ComfyUI客户端...
2025-08-26 17:36:53,827 - __main__ - INFO -    ✅ ComfyUI客户端初始化完成
2025-08-26 17:36:53,828 - __main__ - INFO -    - 正在初始化工作流处理器...
2025-08-26 17:36:53,828 - workflow_processor - INFO - 创建目录: ./temp, ./output, output/video
2025-08-26 17:36:53,828 - __main__ - INFO -    ✅ 工作流处理器初始化完成
2025-08-26 17:36:53,828 - __main__ - INFO - ✅ 所有客户端初始化完成
2025-08-26 17:36:53,828 - __main__ - INFO - 📊 步骤3: 获取飞书表格数据
2025-08-26 17:36:53,828 - __main__ - INFO -    - 正在连接飞书API...
2025-08-26 17:36:53,828 - __main__ - INFO - ▶️ 执行正常处理模式
2025-08-26 17:36:53,828 - workflow_processor - INFO - 🚀 开始工作流处理...
2025-08-26 17:36:53,828 - workflow_processor - INFO - ==================================================
2025-08-26 17:36:53,828 - workflow_processor - INFO - 📊 步骤1: 获取飞书表格数据
2025-08-26 17:36:53,828 - workflow_processor - INFO -    - 正在连接飞书API...
2025-08-26 17:36:53,828 - feishu_client - INFO -            📋 获取工作表信息...
2025-08-26 17:36:54,107 - feishu_client - INFO - Token获取成功
2025-08-26 17:36:54,494 - feishu_client - INFO - 找到目标工作表: prd_model_sheet
2025-08-26 17:36:54,496 - feishu_client - INFO -            ✅ 工作表信息获取成功: prd_model_sheet
2025-08-26 17:36:54,496 - feishu_client - INFO -            🔗 构建数据请求...
2025-08-26 17:36:54,496 - feishu_client - INFO -            - 请求范围: A2:I1000
2025-08-26 17:36:54,496 - feishu_client - INFO -            🌐 发送API请求...
2025-08-26 17:36:54,924 - feishu_client - INFO -            ✅ API请求成功 (状态码: 0)
2025-08-26 17:36:54,924 - feishu_client - INFO -            📊 解析响应数据...
2025-08-26 17:36:54,925 - feishu_client - INFO -            - 原始数据行数: 999
2025-08-26 17:36:54,925 - feishu_client - INFO -            🔍 解析表格数据...
2025-08-26 17:36:54,925 - feishu_client - INFO - 使用默认列索引映射
2025-08-26 17:36:54,925 - feishu_client - INFO - 列映射: {'product_image': 0, 'model_image': 1, 'prompt': 2, 'status': 3, 'product_name': 5, 'model_name': 7, 'video_status': 8}
2025-08-26 17:36:54,925 - feishu_client - INFO - 解析行 1: 原始数据长度=9, product_name_idx=5
2025-08-26 17:36:54,926 - feishu_client - INFO - F列原始数据: '0826-Abvela'
2025-08-26 17:36:54,926 - feishu_client - INFO - 解析后的产品名: '0826-Abvela'
2025-08-26 17:36:54,926 - feishu_client - INFO - 解析行 2: 原始数据长度=9, product_name_idx=5
2025-08-26 17:36:54,926 - feishu_client - INFO - F列原始数据: '0826-freaks'
2025-08-26 17:36:54,926 - feishu_client - INFO - 解析后的产品名: '0826-freaks'
2025-08-26 17:36:54,926 - feishu_client - INFO - 解析行 3: 原始数据长度=9, product_name_idx=5
2025-08-26 17:36:54,926 - feishu_client - INFO - F列原始数据: '0826-beautifully broken'
2025-08-26 17:36:54,926 - feishu_client - INFO - 解析后的产品名: '0826-beautifully broken'
2025-08-26 17:36:54,926 - feishu_client - INFO - 解析行 4: 原始数据长度=9, product_name_idx=5
2025-08-26 17:36:54,926 - feishu_client - INFO - F列原始数据: '0826-HIPPIE SOUL'
2025-08-26 17:36:54,927 - feishu_client - INFO - 解析后的产品名: '0826-HIPPIE SOUL'
2025-08-26 17:36:54,927 - feishu_client - INFO - 解析行 5: 原始数据长度=9, product_name_idx=5
2025-08-26 17:36:54,927 - feishu_client - INFO - F列原始数据: '0826-life is better'
2025-08-26 17:36:54,927 - feishu_client - INFO - 解析后的产品名: '0826-life is better'
2025-08-26 17:36:54,927 - feishu_client - INFO - 解析行 6: 原始数据长度=9, product_name_idx=5
2025-08-26 17:36:54,927 - feishu_client - INFO - F列原始数据: '0826-Abvela'
2025-08-26 17:36:54,927 - feishu_client - INFO - 解析后的产品名: '0826-Abvela'
2025-08-26 17:36:54,927 - feishu_client - INFO - 解析行 7: 原始数据长度=9, product_name_idx=5
2025-08-26 17:36:54,928 - feishu_client - INFO - F列原始数据: '0826-freaks'
2025-08-26 17:36:54,928 - feishu_client - INFO - 解析后的产品名: '0826-freaks'
2025-08-26 17:36:54,928 - feishu_client - INFO - 解析行 8: 原始数据长度=9, product_name_idx=5
2025-08-26 17:36:54,928 - feishu_client - INFO - F列原始数据: '0826-beautifully broken'
2025-08-26 17:36:54,928 - feishu_client - INFO - 解析后的产品名: '0826-beautifully broken'
2025-08-26 17:36:54,928 - feishu_client - INFO - 解析行 9: 原始数据长度=9, product_name_idx=5
2025-08-26 17:36:54,928 - feishu_client - INFO - F列原始数据: '0826-HIPPIE SOUL'
2025-08-26 17:36:54,928 - feishu_client - INFO - 解析后的产品名: '0826-HIPPIE SOUL'
2025-08-26 17:36:54,928 - feishu_client - INFO - 解析行 10: 原始数据长度=9, product_name_idx=5
2025-08-26 17:36:54,928 - feishu_client - INFO - F列原始数据: '0826-life is better'
2025-08-26 17:36:54,929 - feishu_client - INFO - 解析后的产品名: '0826-life is better'
2025-08-26 17:36:54,930 - feishu_client - INFO - 处理了 10 行有效数据
2025-08-26 17:36:54,930 - feishu_client - INFO -            ✅ 数据解析完成
2025-08-26 17:36:54,930 - feishu_client - INFO -            - 有效数据行数: 10
2025-08-26 17:36:54,931 - workflow_processor - INFO -    ✅ 成功获取 10 行数据
2025-08-26 17:36:54,931 - workflow_processor - INFO - 🔍 步骤2: 数据预处理和筛选
2025-08-26 17:36:54,931 - workflow_processor - INFO -    ⏭️  跳过已处理的行 2
2025-08-26 17:36:54,931 - workflow_processor - INFO -    ⏭️  跳过已处理的行 3
2025-08-26 17:36:54,931 - workflow_processor - INFO -    ⏭️  跳过已处理的行 4
2025-08-26 17:36:54,932 - workflow_processor - INFO -    ⏭️  跳过已处理的行 5
2025-08-26 17:36:54,932 - workflow_processor - INFO -    ⏭️  跳过已处理的行 6
2025-08-26 17:36:54,932 - workflow_processor - INFO -    - 总行数: 10
2025-08-26 17:36:54,932 - workflow_processor - INFO -    - 需要处理: 5 行
2025-08-26 17:36:54,932 - workflow_processor - INFO -    - 跳过行数: 5 行
2025-08-26 17:36:54,932 - workflow_processor - INFO - ⚙️  步骤3: 开始逐行处理数据
2025-08-26 17:36:54,932 - workflow_processor - INFO -    🔄 队列管理已启用 - 检查间隔: 120秒
2025-08-26 17:36:54,936 - workflow_processor - INFO -    📝 处理进度: 1/5 - 行 7
2025-08-26 17:36:54,937 - workflow_processor - INFO -      🔄 开始处理第 7 行数据
2025-08-26 17:36:54,937 - workflow_processor - INFO -      📋 工作流类型: image_composite
2025-08-26 17:36:54,937 - workflow_processor - INFO -      🔍 子步骤1: 验证数据完整性
2025-08-26 17:36:54,937 - workflow_processor - ERROR -         ❌ 数据验证失败: 提示词为空
2025-08-26 17:36:54,937 - workflow_processor - ERROR -    ❌ 行 7 处理失败: 提示词为空
2025-08-26 17:36:55,310 - feishu_client - INFO - 找到目标工作表: prd_model_sheet
2025-08-26 17:36:55,801 - feishu_client - INFO - 行 7 状态更新为: 处理失败: 提示词为空
2025-08-26 17:36:55,802 - workflow_processor - INFO -    ⏱️  等待 2 秒避免API限制...
2025-08-26 17:36:57,804 - workflow_processor - INFO -    📝 处理进度: 2/5 - 行 8
2025-08-26 17:36:57,804 - workflow_processor - INFO -      🔄 开始处理第 8 行数据
2025-08-26 17:36:57,804 - workflow_processor - INFO -      📋 工作流类型: image_composite
2025-08-26 17:36:57,804 - workflow_processor - INFO -      🔍 子步骤1: 验证数据完整性
2025-08-26 17:36:57,805 - workflow_processor - ERROR -         ❌ 数据验证失败: 提示词为空
2025-08-26 17:36:57,805 - workflow_processor - ERROR -    ❌ 行 8 处理失败: 提示词为空
2025-08-26 17:36:58,307 - feishu_client - INFO - 找到目标工作表: prd_model_sheet
2025-08-26 17:36:58,797 - feishu_client - INFO - 行 8 状态更新为: 处理失败: 提示词为空
2025-08-26 17:36:58,798 - workflow_processor - INFO -    ⏱️  等待 2 秒避免API限制...
2025-08-26 17:37:00,799 - workflow_processor - INFO -    📝 处理进度: 3/5 - 行 9
2025-08-26 17:37:00,799 - workflow_processor - INFO -      🔄 开始处理第 9 行数据
2025-08-26 17:37:00,799 - workflow_processor - INFO -      📋 工作流类型: image_composite
2025-08-26 17:37:00,799 - workflow_processor - INFO -      🔍 子步骤1: 验证数据完整性
2025-08-26 17:37:00,799 - workflow_processor - ERROR -         ❌ 数据验证失败: 提示词为空
2025-08-26 17:37:00,799 - workflow_processor - ERROR -    ❌ 行 9 处理失败: 提示词为空
2025-08-26 17:37:01,196 - feishu_client - INFO - 找到目标工作表: prd_model_sheet
2025-08-26 17:37:01,621 - feishu_client - INFO - 行 9 状态更新为: 处理失败: 提示词为空
2025-08-26 17:37:01,622 - workflow_processor - INFO -    ⏱️  等待 2 秒避免API限制...
2025-08-26 17:37:03,623 - workflow_processor - INFO -    📝 处理进度: 4/5 - 行 10
2025-08-26 17:37:03,623 - workflow_processor - INFO -      🔄 开始处理第 10 行数据
2025-08-26 17:37:03,623 - workflow_processor - INFO -      📋 工作流类型: image_composite
2025-08-26 17:37:03,623 - workflow_processor - INFO -      🔍 子步骤1: 验证数据完整性
2025-08-26 17:37:03,623 - workflow_processor - ERROR -         ❌ 数据验证失败: 提示词为空
2025-08-26 17:37:03,623 - workflow_processor - ERROR -    ❌ 行 10 处理失败: 提示词为空
2025-08-26 17:37:04,092 - feishu_client - INFO - 找到目标工作表: prd_model_sheet
2025-08-26 17:37:04,563 - feishu_client - INFO - 行 10 状态更新为: 处理失败: 提示词为空
2025-08-26 17:37:04,563 - workflow_processor - INFO -    ⏱️  等待 2 秒避免API限制...
2025-08-26 17:37:06,565 - workflow_processor - INFO -    📝 处理进度: 5/5 - 行 11
2025-08-26 17:37:06,565 - workflow_processor - INFO -      🔄 开始处理第 11 行数据
2025-08-26 17:37:06,565 - workflow_processor - INFO -      📋 工作流类型: image_composite
2025-08-26 17:37:06,566 - workflow_processor - INFO -      🔍 子步骤1: 验证数据完整性
2025-08-26 17:37:06,566 - workflow_processor - ERROR -         ❌ 数据验证失败: 提示词为空
2025-08-26 17:37:06,566 - workflow_processor - ERROR -    ❌ 行 11 处理失败: 提示词为空
2025-08-26 17:37:07,005 - feishu_client - INFO - 找到目标工作表: prd_model_sheet
2025-08-26 17:37:07,444 - feishu_client - INFO - 行 11 状态更新为: 处理失败: 提示词为空
2025-08-26 17:37:07,444 - workflow_processor - INFO - 📈 步骤4: 处理结果统计
2025-08-26 17:37:07,445 - workflow_processor - INFO - ==================================================
2025-08-26 17:37:07,445 - workflow_processor - INFO - ✅ 工作流处理完成
2025-08-26 17:37:07,445 - workflow_processor - INFO -    - 处理总数: 5 行
2025-08-26 17:37:07,445 - workflow_processor - INFO -    - 成功数量: 0 行
2025-08-26 17:37:07,445 - workflow_processor - INFO -    - 失败数量: 5 行
2025-08-26 17:37:07,446 - workflow_processor - INFO -    - 成功率: 0.0%
2025-08-26 17:37:07,446 - workflow_processor - INFO - ==================================================
2025-08-26 17:37:07,446 - __main__ - INFO - 📋 步骤4: 生成处理报告
2025-08-26 17:37:07,446 - __main__ - INFO - 
=== 工作流处理报告 ===
总处理行数: 5
成功行数: 0
失败行数: 5
成功率: 0.0%

处理失败的行:
  行 7: 提示词为空
  行 8: 提示词为空
  行 9: 提示词为空
  行 10: 提示词为空
  行 11: 提示词为空


2025-08-26 17:37:07,447 - __main__ - INFO - 处理报告已保存到: reports/report_20250826_173707.txt
2025-08-26 17:37:07,447 - __main__ - WARNING - 部分数据处理失败: 0/5
